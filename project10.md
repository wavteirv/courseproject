椭圆曲线
域k(特征0)上的椭圆曲线可看成由下面方程的解全体再加上一个无穷远点：$y^2=x^3+ax+b,(x,y)\in k^2$，a,b为常数，并且判别式$\Delta =-16(4a^3+27b^2) \neq 0$不等于0。(即为了光滑性要求无重根)。

椭圆曲线上的点全体构成一个加法群， 点与点之间的“加法”运算。 正因为椭圆曲线存在加法结构，所以它包含了很多重要的数论信息。

对于密码学，椭圆曲线是连续的，并不适合用于加密。因此，椭圆曲线密码学的第一要务就是把椭圆曲线定义在有限域上，（有限域$F_p$ ，p为素数），并提出一条适于加密的曲线：$y^2=x^3+ax+b\ (mod\ p)$。

椭圆曲线通常与离散对数问题关联。椭圆曲线上的离散对数问题是指，对于一个曲线上的点$P=k*G$，$G$为基点。已知$P$和$G$，计算k是困难的，这就引出了公钥密码学的应用。

相比起在商业中被广泛采用的RSA加密算法，ECC优势是可以使用更短的密钥，来实现与RSA相当或更高级别的安全。通过下图我们清楚的发现，160位ECC加密安全性相当于1024位RSA加密，而210位ECC加密安全性甚至相当于2048位RSA加密。

ECDSA
即椭圆曲线数字签名算法，是DSA算法在椭圆曲线上的变形应用。

最原始的算法过程如下：

公私钥生成
随机取整数$d_A\in [1,n-1]$作为私钥。n为椭圆曲线群的阶。

计算$Q=d_A*G$作为公钥，G为基点。

计算签名
生成随机数k。

计算$P=k*G$，得到曲线上一个点

取$P$的坐标x，令$r=x\ (mod\ n)$

计算消息m的hash值H(m)

计算$s=k^{-1}(H(m)+d_Ar)\ (mod\ n)$

输出$(r,s)$作为签名。

验证者需要得到签名对应的消息和公钥才可以验证签名合法性。

比特币中的ECDSA
对于256位模数，私钥是256位的整数，而公钥两个坐标均为256位，共64字节。

而比特币交易的信息中，公钥信息占了较大的一部分。如果有方法可以降低公钥使用的大小，则可以有效地降低每笔交易整体的大小，使得一个区块可以承载更多交易，整个系统会更加高效。

一个很有效的优化是对于公钥的压缩。

对于已知的椭圆曲线，如果知道点的横坐标，根据曲线关于y轴对称的特性，可以得到两个可能的点。而这两个点事实上只需要1个bit就可以区分。这样就只需要保留32字节的横坐标x和额外的1位（实际的做法是以一个字节0x02或0x03来区分）来唯一标识一个点。从而将原来的64字节降低到33字节。

进一步地，如果能只根据签名值就能推导出公钥，那么就可以完全省去其占用的64字节。这引出了推导的技术。

以太坊ECDSA
以太坊使用的ECDSA签名在原来的基础上引入了一个额外的恢复标识符v（1byte），签名值可表示成$(r,s,v)$。

在Ethereum中，ECDSA签名和验证用于以下目的：

交易签名：在Ethereum中，每个交易都需要由发送方进行数字签名，以证明交易的合法性和防止篡改。发送方使用其私钥对交易进行签名，并将签名附加到交易数据中。接收方可以使用发送方的公钥验证签名的有效性。

区块签名：在Ethereum中，每个区块也需要进行签名，以确保区块的完整性和防止恶意的区块添加。区块中包含了所有交易的摘要以及前一个区块的哈希值。区块的创建者使用其私钥对区块数据进行签名，并将签名附加到区块头中。其他节点可以使用创建者的公钥验证签名的有效性。

消息验证：除了交易和区块之外，Ethereum中的智能合约也可能使用ECDSA签名和验证来验证消息的合法性。智能合约可以接收外部消息，并使用发送方提供的签名验证消息的真实性。

在使用ECDSA进行签名和验证时，需要注意以下几点：

安全性：选择适当的椭圆曲线和哈希函数非常重要，以确保签名的安全性。Ethereum使用SECP256K1曲线和SHA-3哈希函数。

私钥管理：私钥是签名的关键，必须妥善保管，防止泄露。一旦私钥泄露，黑客可能会冒充签名者进行欺诈。

签名验证：在验证签名时，必须确保使用正确的公钥。否则，签名可能会被错误地拒绝或接受。

批处理技术：如上述回答所示，批处理技术可以提高签名和验证的效率，特别是在批量处理多个交易或区块时。

总结：ECDSA是Ethereum中广泛使用的数字签名算法，用于交易、区块和消息的签名和验证。在实际应用中，ECDSA的安全性和效率非常重要，需要合理选择参数和实施安全措施来确保系统的稳健性和安全性。
