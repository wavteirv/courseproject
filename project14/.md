## 实验报告：使用SM2实现PGP方案

### 1. 引言

PGP是一种常用的加密方案，用于保护电子通信的隐私和安全性。本实验旨在使用SM2算法实现一个简化的PGP方案，包括密钥生成、加密、解密和数字签名。

### 2. 原理

#### 2.1 SM2算法

SM2是一种非对称加密算法，广泛用于数字签名和密钥交换。它基于椭圆曲线密码学，采用了国家密码管理局（中国）发布的标准。

SM2密钥生成过程：
- 选择椭圆曲线参数，包括曲线方程、基点、阶数等。
- 随机生成私钥d，并计算公钥P = d * G，其中G是基点。
- 公钥P和曲线参数构成用户的公钥参数。

SM2数字签名过程：
- 选择一个随机数k，并计算点R = k * G。
- 计算消息的哈希值H = Hash(message)。
- 计算s = (H + d * r) / k，其中r是R的x坐标。
- 签名结果为(R, s)。

SM2密钥交换过程：
- 选择一个随机数k，并计算点R = k * G。
- 将点R的x坐标的一部分作为临时密钥x_1。
- 对方计算临时密钥x_2，并根据x_2计算出共享密钥。

#### 2.2 PGP方案

PGP是一种更复杂的加密方案，通常包括对称加密和非对称加密的组合，以及数字签名。我们将简化PGP方案，使用SM2算法实现非对称加密和数字签名。

简化PGP方案流程：
1. 密钥生成阶段：
   - 选择椭圆曲线参数和基点G。
   - 随机生成私钥d，并计算公钥P = d * G。

2. 加密阶段：
   - 接收方生成临时密钥对，同样使用SM2算法。
   - 发送方将消息使用临时公钥加密，得到密文C1。
   - 发送方使用自己的私钥对临时公钥进行数字签名，得到签名S。
   - 发送方将C1和S发送给接收方。

3. 解密阶段：
   - 接收方使用自己的私钥对密文中的临时公钥进行解密，得到明文消息
   - 接收方使用发送方的公钥对签名进行验证，确保消息来源正确和完整。

### 3. 实验步骤

1. 密钥生成：
   - 选择椭圆曲线参数和基点G。
   - 生成发送方的私钥d和公钥P = d * G。
   - 生成接收方的私钥d'和公钥P' = d' * G。

2. 加密：
   - 选择随机数k，并计算临时公钥R = k * G。
   - 将R的x坐标的一部分作为临时密钥x_1。
   - 将明文消息使用临时公钥加密得到密文C1。
   - 计算签名s = (Hash(C1) + d * x_1) / k。
   - 得到密文C = (C1, s)。

3. 解密：
   - 接收方使用自己的私钥d'对C1进行解密，得到明文消息。
   - 接收方使用发送方的公钥P对签名s进行验证，确保消息来源正确和完整。
     
<img width="224" alt="屏幕截图 2023-08-04 223031" src="https://github.com/wavteirv/courseproject/assets/102475494/dbffbcab-a800-47f4-bd60-cebd9d3529d3">

